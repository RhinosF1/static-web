{{ partial "header" . }}

<article class="post">
    <header>
        <h1>Communities of Snoonet</h1>
    </header>

    <section class="content">
        <ol>
            {{ range $k, $v := .Site.Params.communityTypes }}
                {{ range $c := $v }}
                    <li><a href="#{{ $k }}">{{ $c.Name }}</a></li>
                {{ end }}
            {{ end }}
        </ol>
    </section>
</article>

{{ range $k, $v := .Site.Params.communityTypes }}
    {{ range $c := $v }}
        <article class="post" id="{{ $k }}">
            <header>
                <h2>{{ $c.Name }}</h2>
            </header>
            <section class="content">
                <table>
                    <colgroup>
                        <col style="width: 30%">
                        <col style="width: 50%">
                        <col style="width: auto">
                    </colgroup>
                    <thead>
                        <tr>
                            <th>Channel</th>
                            <th>Subreddit</th>
                            <th>Community Bio</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{ range (where $.Pages "Params.kind" $k).ByTitle }}
                            <tr>
                                <td>
                                    <a href="{{ printf "%s%s" .Site.Params.webchatBaseURL .Title }}">
                                        {{ .Title }}
                                    </a>
                                </td>
                                <td>
                                    {{ if .Params.subreddit }}
                                        <a href="{{ printf "%s%s" .Site.Params.redditBaseURL .Params.subreddit }}">
                                            {{ .Params.subreddit }}
                                        </a>
                                    {{ else if .Params.subreddits }}
                                        {{ $len := (len .Params.subreddits) }}
                                        {{ range $i, $sr := .Params.subreddits }}

                                            <a href="{{ printf "%s%s" $.Site.Params.redditBaseURL $sr }}">
                                                {{ $sr }}
                                            </a>
                                            {{ if lt $i (sub $len 1) }} &amp; {{ end }}
                                        {{ end }}
                                    {{ else }}
                                        <span class="secondary-text">N/A</span>
                                    {{ end }}
                                </td>
                                <td>
                                    {{ if .Content }}
                                        <a href="{{ .RelPermalink }}">Bio</a>
                                    {{ else }}
                                        <span class="secondary-text">N/A</span>
                                    {{ end }}
                                </td>
                            </tr>
                        {{ end }}
                    </tbody>
                </table>
            </section>

            <footer class="footer">
                {{ partial "back_to_top.html" . }}
            </footer>
        </article>
    {{ end }}
{{ end }}

{{ partial "footer" . }}
